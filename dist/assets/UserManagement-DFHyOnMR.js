import{_ as ae}from"./_plugin-vue_export-helper--ScQKs0c.js";/* empty css                   *//* empty css                   *//* empty css                     *//* empty css               *//* empty css                        *//* empty css                  *//* empty css                 *//* empty css                  */import{r as m,m as A,z as le,a2 as te,c as oe,o as I,d as p,U as se,e as a,w as o,Y as ne,i as ue,j as re,X as ie,H as de,L as me,O as pe,f as ve,k as f,M as ce,N as fe,D as ge,a1 as we,g as be,h as _e,a3 as D,J as he,K as Ve,l as v,_ as ye}from"./index-Dr9TPxTp.js";const Ce={class:"user-management-container"},Ue={class:"header"},$e={class:"operation-area"},xe={class:"pagination-container"},ke={class:"password-strength"},De={class:"dialog-footer"},Ee={class:"dialog-footer"},Le={__name:"UserManagement",setup(Se){const E=Array.from({length:50},(l,e)=>({id:e+1,username:`user${e+1}`,email:`user${e+1}@example.com`,role:["admin","operator","auditor"][Math.floor(Math.random()*3)],status:Math.random()>.3?"active":"inactive",lastLogin:new Date(Date.now()-Math.floor(Math.random()*7*24*60*60*1e3)).toLocaleString()})),N=[{time:new Date().toLocaleString(),action:"添加用户",operator:"admin",target:"user51",details:"添加了新用户user51，角色为操作员"},{time:new Date(Date.now()-1e3*60*5).toLocaleString(),action:"修改状态",operator:"admin",target:"user12",details:"将用户user12状态修改为禁用"},{time:new Date(Date.now()-1e3*60*30).toLocaleString(),action:"删除用户",operator:"auditor1",target:"user7",details:"删除了用户user7"}],i=m([]),U=m(!1),_=m(""),g=m(1),h=m(10),$=m(0),V=m(!1),y=m(!1),L=m(!1),S=m(N),n=m({username:"",email:"",password:"",role:"operator"}),s=m({id:0,username:"",email:"",password:"",role:"",status:"active"}),x=A(()=>n.value.password?n.value.password.length<6?"weak":n.value.password.length<10?"medium":"strong":""),F=A(()=>{let l=i.value;if(_.value){const d=_.value.toLowerCase();l=l.filter(r=>r.username.toLowerCase().includes(d)||r.email.toLowerCase().includes(d))}$.value=l.length;const e=(g.value-1)*h.value,u=e+h.value;return l.slice(e,u)}),j=()=>{U.value=!0,setTimeout(()=>{i.value=E,$.value=E.length,U.value=!1,w("查看用户列表","系统","","加载了所有用户数据")},800)},z=()=>{g.value=1,w("搜索用户","系统","",`搜索关键词: ${_.value}`)},K=()=>{g.value=1},P=l=>{h.value=l},O=l=>{g.value=l},R=()=>{if(!n.value.username||!n.value.email||!n.value.password){v.warning("请填写完整信息");return}if(i.value.some(e=>e.username===n.value.username)){v.warning("用户名已存在");return}if(i.value.some(e=>e.email===n.value.email)){v.warning("邮箱已被注册");return}const l={id:i.value.length+1,username:n.value.username,email:n.value.email,role:n.value.role,status:"active",lastLogin:new Date().toLocaleString()};i.value.unshift(l),V.value=!1,v.success("添加用户成功"),w("添加用户","admin",l.username,`添加了新用户: ${l.username}, 角色: ${l.role}`),n.value={username:"",email:"",password:"",role:"operator"}},H=l=>{s.value={id:l.id,username:l.username,email:l.email,password:"",role:l.role,status:l.status},y.value=!0},J=()=>{if(!s.value.email){v.warning("请填写邮箱");return}const l=i.value.findIndex(e=>e.id===s.value.id);if(l!==-1){const e={...i.value[l]};i.value[l].email=s.value.email,i.value[l].role=s.value.role,i.value[l].status=s.value.status,s.value.password&&v.success("密码已更新"),y.value=!1,v.success("用户信息已更新");let u=[];e.email!==s.value.email&&u.push(`邮箱从 ${e.email} 改为 ${s.value.email}`),e.role!==s.value.role&&u.push(`角色从 ${e.role} 改为 ${s.value.role}`),e.status!==s.value.status&&u.push(`状态从 ${e.status} 改为 ${s.value.status}`),s.value.password&&u.push("密码已修改"),u.length>0&&w("修改用户","admin",s.value.username,u.join("; "))}},Q=l=>{ye.confirm(`确定要删除用户 ${l.username} 吗？此操作不可恢复。`,"安全警告",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning",customClass:"security-confirm"}).then(()=>{i.value=i.value.filter(e=>e.id!==l.id),v.success("用户已删除"),w("删除用户","admin",l.username,`删除了用户 ${l.username}`)}).catch(()=>{v.info("已取消删除")})},X=l=>{v.success(`用户 ${l.username} 状态已更新为 ${l.status==="active"?"启用":"禁用"}`),w("修改状态","admin",l.username,`将用户状态修改为 ${l.status}`)},Y=l=>{switch(l){case"admin":return"danger";case"operator":return"primary";case"auditor":return"warning";default:return"info"}},G=({row:l})=>l.status==="inactive"?"inactive-row":"",w=(l,e,u,d)=>{S.value.unshift({time:new Date().toLocaleString(),action:l,operator:e,target:u,details:d})};return le(()=>{j()}),te(()=>n.value.password,l=>{l&&l.length>0}),(l,e)=>{const u=re,d=ue,r=ce,W=fe,M=we,T=me,Z=pe,c=_e,b=Ve,q=he,B=be,k=ve,ee=ie;return I(),oe("div",Ce,[p("div",Ue,[e[20]||(e[20]=p("h2",{class:"system-title"},"网络安全用户管理系统",-1)),p("div",$e,[a(d,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),placeholder:"搜索用户名或邮箱",clearable:"",style:{width:"300px"},onClear:K,onKeyup:ne(z,["enter"]),class:"security-search"},{append:o(()=>[a(u,{onClick:z,class:"search-btn"},{default:o(()=>[...e[18]||(e[18]=[p("span",{class:"search-icon"},"🔍",-1)])]),_:1})]),_:1},8,["modelValue"]),a(u,{type:"primary",onClick:e[1]||(e[1]=t=>V.value=!0),class:"add-user-btn"},{default:o(()=>[...e[19]||(e[19]=[p("span",{class:"btn-icon"},"+",-1),f(" 添加用户 ",-1)])]),_:1})])]),se((I(),de(T,{data:F.value,border:"",style:{width:"100%"},"row-class-name":G,class:"security-table"},{default:o(()=>[a(r,{prop:"id",label:"ID",width:"80",align:"center"}),a(r,{prop:"username",label:"用户名",width:"120"}),a(r,{prop:"email",label:"邮箱",width:"200"}),a(r,{prop:"role",label:"角色",width:"120"},{default:o(t=>[a(W,{type:Y(t.row.role),effect:"light"},{default:o(()=>[f(ge(t.row.role),1)]),_:2},1032,["type"])]),_:1}),a(r,{prop:"status",label:"状态",width:"100",align:"center"},{default:o(t=>[a(M,{modelValue:t.row.status,"onUpdate:modelValue":C=>t.row.status=C,"active-value":"active","inactive-value":"inactive","active-text":"启用","inactive-text":"禁用",onChange:C=>X(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(r,{prop:"lastLogin",label:"最后登录",width:"180"}),a(r,{label:"操作",width:"180",fixed:"right",align:"center"},{default:o(t=>[a(u,{size:"small",onClick:C=>H(t.row),class:"edit-btn"},{default:o(()=>[...e[21]||(e[21]=[f("✏️ 编辑",-1)])]),_:1},8,["onClick"]),a(u,{size:"small",type:"danger",onClick:C=>Q(t.row),class:"delete-btn"},{default:o(()=>[...e[22]||(e[22]=[f("🗑️ 删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ee,U.value]]),p("div",xe,[a(Z,{"current-page":g.value,"onUpdate:currentPage":e[2]||(e[2]=t=>g.value=t),"page-size":h.value,"onUpdate:pageSize":e[3]||(e[3]=t=>h.value=t),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:$.value,onSizeChange:P,onCurrentChange:O,class:"security-pagination"},null,8,["current-page","page-size","total"])]),a(k,{modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=t=>V.value=t),title:"添加新用户",width:"500",class:"security-dialog"},{footer:o(()=>[p("span",De,[a(u,{onClick:e[8]||(e[8]=t=>V.value=!1),class:"cancel-btn"},{default:o(()=>[...e[23]||(e[23]=[f("取消",-1)])]),_:1}),a(u,{type:"primary",onClick:R,class:"confirm-btn"},{default:o(()=>[...e[24]||(e[24]=[f("确认添加",-1)])]),_:1})])]),default:o(()=>[a(B,{model:n.value,"label-width":"100px","label-position":"left"},{default:o(()=>[a(c,{label:"用户名",required:""},{default:o(()=>[a(d,{modelValue:n.value.username,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.username=t),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),a(c,{label:"邮箱",required:""},{default:o(()=>[a(d,{modelValue:n.value.email,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),a(c,{label:"密码",required:""},{default:o(()=>[a(d,{modelValue:n.value.password,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.password=t),type:"password","show-password":"",placeholder:"请输入密码"},null,8,["modelValue"]),p("div",ke,[p("span",{class:D({weak:x.value==="weak"})},"弱",2),p("span",{class:D({medium:x.value==="medium"})},"中",2),p("span",{class:D({strong:x.value==="strong"})},"强",2)])]),_:1}),a(c,{label:"角色",required:""},{default:o(()=>[a(q,{modelValue:n.value.role,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.role=t),placeholder:"请选择角色"},{default:o(()=>[a(b,{label:"管理员",value:"admin"}),a(b,{label:"操作员",value:"operator"}),a(b,{label:"审计员",value:"auditor"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(k,{modelValue:y.value,"onUpdate:modelValue":e[16]||(e[16]=t=>y.value=t),title:"编辑用户信息",width:"500",class:"security-dialog"},{footer:o(()=>[p("span",Ee,[a(u,{onClick:e[15]||(e[15]=t=>y.value=!1),class:"cancel-btn"},{default:o(()=>[...e[25]||(e[25]=[f("取消",-1)])]),_:1}),a(u,{type:"primary",onClick:J,class:"confirm-btn"},{default:o(()=>[...e[26]||(e[26]=[f("确认修改",-1)])]),_:1})])]),default:o(()=>[a(B,{model:s.value,"label-width":"100px","label-position":"left"},{default:o(()=>[a(c,{label:"用户名"},{default:o(()=>[a(d,{modelValue:s.value.username,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.username=t),disabled:""},null,8,["modelValue"])]),_:1}),a(c,{label:"邮箱",required:""},{default:o(()=>[a(d,{modelValue:s.value.email,"onUpdate:modelValue":e[11]||(e[11]=t=>s.value.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),a(c,{label:"密码"},{default:o(()=>[a(d,{modelValue:s.value.password,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.password=t),type:"password","show-password":"",placeholder:"留空则不修改"},null,8,["modelValue"])]),_:1}),a(c,{label:"角色",required:""},{default:o(()=>[a(q,{modelValue:s.value.role,"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.role=t),placeholder:"请选择角色"},{default:o(()=>[a(b,{label:"管理员",value:"admin"}),a(b,{label:"操作员",value:"operator"}),a(b,{label:"审计员",value:"auditor"})]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"状态",required:""},{default:o(()=>[a(M,{modelValue:s.value.status,"onUpdate:modelValue":e[14]||(e[14]=t=>s.value.status=t),"active-value":"active","inactive-value":"inactive","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(k,{modelValue:L.value,"onUpdate:modelValue":e[17]||(e[17]=t=>L.value=t),title:"安全审计日志",width:"700",class:"audit-log-dialog"},{default:o(()=>[a(T,{data:S.value,border:"",style:{width:"100%"}},{default:o(()=>[a(r,{prop:"time",label:"时间",width:"150"}),a(r,{prop:"action",label:"操作",width:"120"}),a(r,{prop:"operator",label:"操作人",width:"120"}),a(r,{prop:"target",label:"目标用户",width:"120"}),a(r,{prop:"details",label:"详细信息"})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}},Ke=ae(Le,[["__scopeId","data-v-69130d65"]]);export{Ke as default};
