import{_ as _e}from"./_plugin-vue_export-helper--ScQKs0c.js";/* empty css                   *//* empty css                             *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                     *//* empty css                       */import{i as j}from"./index-CUSTx1TY.js";/* empty css                */import{r as i,m as ye,z as be,c as S,o as g,e as t,w as l,A as ge,f as he,B as J,q as we,C as Ce,E as Ee,d as o,D as u,F as Se,G as ke,k as r,H as xe,I as k,i as Ve,j as Ie,g as Me,h as De,J as Ae,K as Fe,L as $e,M as Pe,N as Le,O as Te,P as Re,Q as ze,l as N}from"./index-Dr9TPxTp.js";const Be={class:"home-container"},Ue={class:"stat-content"},Ge={class:"stat-icon bg-primary"},Ne={class:"stat-info"},Oe={class:"stat-value"},We={class:"stat-desc"},qe={class:"stat-content"},He={class:"stat-icon bg-success"},Qe={class:"stat-info"},je={class:"stat-value"},Je={class:"stat-desc"},Ke={class:"stat-content"},Xe={class:"stat-icon bg-warning"},Ye={class:"stat-info"},Ze={class:"stat-value"},et={class:"stat-desc"},tt={class:"stat-content"},lt={class:"stat-icon bg-danger"},ot={class:"stat-info"},st={class:"stat-value"},at={class:"stat-desc"},nt={class:"card-header"},it={class:"chart-container"},rt={class:"chart-container"},ut={class:"card-header"},dt={class:"search-form"},ct={class:"pagination-container"},pt={key:0},mt={key:0,class:"event-analysis"},vt={key:1,class:"event-solution"},ft={__name:"Home",setup(_t){const x=i({total:128,online:124}),V=i({total:12,today:3}),I=i({current:"1.2Gbps",peak:"1.8Gbps"}),M=i({total:24,critical:8}),D=i("day"),A=i(null),F=i(null);let $=null,P=null;const f=i([{id:1,time:"2023-05-15 08:23:45",type:"高危",source:"防火墙",description:"检测到SQL注入攻击",analysis:"攻击者尝试通过注入恶意SQL代码来获取数据库敏感信息",solution:"已自动阻断攻击IP，建议检查应用层防护规则并更新WAF策略"},{id:2,time:"2023-05-15 10:12:33",type:"中危",source:"IDS",description:"端口扫描活动",analysis:"检测到来自外部IP的端口扫描行为，可能是攻击者在进行网络探测",solution:"已记录攻击IP，建议加强边界防火墙规则并监控该IP活动"},{id:3,time:"2023-05-14 15:45:21",type:"低危",source:"服务器",description:"弱密码尝试",analysis:"检测到多次使用常见弱密码的登录尝试",solution:"已临时锁定账户，建议用户修改为强密码并启用双因素认证"},{id:4,time:"2023-05-14 09:30:15",type:"高危",source:"WAF",description:"XSS攻击拦截",analysis:"攻击者尝试通过跨站脚本攻击获取用户会话信息",solution:"已拦截攻击请求，建议检查并更新Web应用输入过滤规则"},{id:5,time:"2023-05-13 14:22:10",type:"中危",source:"防火墙",description:"异常流量",analysis:"检测到来自单一IP的异常高流量，可能是DDoS攻击的一部分",solution:"已启用流量清洗，建议持续监控网络流量模式"},{id:6,time:"2023-05-13 11:05:43",type:"低危",source:"终端",description:"未授权访问尝试",analysis:"检测到对受限资源的访问尝试，可能是内部员工权限滥用",solution:"已记录访问日志，建议审查用户权限分配"},{id:7,time:"2023-05-12 16:33:28",type:"高危",source:"IDS",description:"暴力破解攻击",analysis:"检测到针对管理接口的暴力破解尝试，攻击者尝试猜测密码",solution:"已锁定攻击IP，建议启用账户锁定机制和登录失败报警"},{id:8,time:"2023-05-12 13:20:17",type:"中危",source:"服务器",description:"可疑进程启动",analysis:"检测到服务器上启动了未知的可执行文件，可能是恶意软件",solution:"已隔离受影响服务器，建议进行全盘扫描并检查系统完整性"}]),h=i(!1),d=i({type:"",source:"",description:""}),O=i(null),K={type:[{required:!0,message:"请选择事件类型",trigger:"change"}],source:[{required:!0,message:"请输入来源",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]},L=i(""),w=i(1),T=i(5),_=i(!1),y=i(!1),c=i(null),R=i(null),X=ye(()=>{const s=L.value.toLowerCase();return f.value.filter(a=>a.type.toLowerCase().includes(s)||a.source.toLowerCase().includes(s)||a.description.toLowerCase().includes(s)).slice((w.value-1)*T.value,w.value*T.value)}),W=s=>{switch(s){case"高危":return"danger";case"中危":return"warning";case"低危":return"info";default:return""}},Y=s=>{w.value=s},Z=()=>{O.value.validate(s=>{if(s){const e=f.value.length>0?Math.max(...f.value.map(m=>m.id))+1:1,a=new Date,p=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}:${String(a.getSeconds()).padStart(2,"0")}`;f.value.unshift({id:e,time:p,type:d.value.type,source:d.value.source,description:d.value.description,analysis:"新添加事件，待安全团队分析",solution:"请等待安全团队处理建议"}),h.value=!1,d.value={type:"",source:"",description:""},ie({id:e,...d.value}),N.success("安全事件添加成功")}})},ee=s=>{c.value=s,_.value=!0},te=s=>{R.value=s,y.value=!0},le=()=>{const s=f.value.findIndex(e=>e.id===R.value);s!==-1&&(f.value.splice(s,1),re(R.value),N.success("安全事件删除成功")),y.value=!1},oe=s=>{N.success(`已处理安全事件: ${s.description}`),_.value=!1},q=()=>{const s=ne(D.value);se(s)},se=s=>{J(()=>{!$&&A.value&&($=j(A.value));const e={tooltip:{trigger:"axis",formatter:"{b}<br/>流量: {c} Mbps"},xAxis:{type:"category",data:s.labels,axisLine:{lineStyle:{color:"#999"}}},yAxis:{type:"value",name:"流量(Mbps)",axisLine:{lineStyle:{color:"#999"}},splitLine:{lineStyle:{type:"dashed"}}},series:[{name:"入站流量",type:"line",smooth:!0,data:s.inbound,lineStyle:{width:3,color:"#409EFF"},itemStyle:{color:"#409EFF"}},{name:"出站流量",type:"line",smooth:!0,data:s.outbound,lineStyle:{width:3,color:"#67C23A"},itemStyle:{color:"#67C23A"}}],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}};$.setOption(e)})},ae=()=>{J(()=>{!P&&F.value&&(P=j(F.value));const s={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center",data:["高危","中危","低危","信息"]},series:[{name:"告警分布",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:8,name:"高危",itemStyle:{color:"#F56C6C"}},{value:15,name:"中危",itemStyle:{color:"#E6A23C"}},{value:20,name:"低危",itemStyle:{color:"#909399"}},{value:5,name:"信息",itemStyle:{color:"#409EFF"}}]}]};P.setOption(s)})},ne=s=>{const e={labels:[],inbound:[],outbound:[]};if(s==="day")for(let a=0;a<24;a++)e.labels.push(`${a}:00`),e.inbound.push(Math.round(Math.random()*500+200)),e.outbound.push(Math.round(Math.random()*300+100));else if(s==="week")["周一","周二","周三","周四","周五","周六","周日"].forEach(p=>{e.labels.push(p),e.inbound.push(Math.round(Math.random()*800+300)),e.outbound.push(Math.round(Math.random()*500+200))});else for(let a=1;a<=30;a++)e.labels.push(`${a}日`),e.inbound.push(Math.round(Math.random()*1e3+400)),e.outbound.push(Math.round(Math.random()*600+300));return e},ie=s=>{console.log("API调用: 添加安全事件",s)},re=s=>{console.log("API调用: 删除安全事件",s)};return be(()=>{q(),ae(),setTimeout(()=>{x.value={total:135,online:130},V.value={total:15,today:4},I.value={current:"1.5Gbps",peak:"2.1Gbps"},M.value={total:28,critical:10}},1e3)}),(s,e)=>{const a=we("svg-icon"),p=Ee,m=Ce,z=ge,B=ke,ue=Se,U=Ve,v=Ie,G=Fe,de=Ae,C=De,ce=Me,b=Pe,H=Le,pe=$e,me=Te,E=ze,ve=Re,Q=he;return g(),S("div",Be,[t(z,{gutter:20,class:"dashboard-row"},{default:l(()=>[t(m,{xs:24,sm:12,lg:6,class:"mb-20"},{default:l(()=>[t(p,{class:"stat-card",shadow:"hover"},{default:l(()=>[o("div",Ue,[o("div",Ge,[t(a,{name:"network"})]),o("div",Ne,[e[12]||(e[12]=o("h3",null,"网络设备",-1)),o("p",Oe,u(x.value.total),1),o("p",We,"在线: "+u(x.value.online),1)])])]),_:1})]),_:1}),t(m,{xs:24,sm:12,lg:6,class:"mb-20"},{default:l(()=>[t(p,{class:"stat-card",shadow:"hover"},{default:l(()=>[o("div",qe,[o("div",He,[t(a,{name:"alert"})]),o("div",Qe,[e[13]||(e[13]=o("h3",null,"安全告警",-1)),o("p",je,u(V.value.total),1),o("p",Je,"今日新增: "+u(V.value.today),1)])])]),_:1})]),_:1}),t(m,{xs:24,sm:12,lg:6,class:"mb-20"},{default:l(()=>[t(p,{class:"stat-card",shadow:"hover"},{default:l(()=>[o("div",Ke,[o("div",Xe,[t(a,{name:"traffic"})]),o("div",Ye,[e[14]||(e[14]=o("h3",null,"网络流量",-1)),o("p",Ze,u(I.value.current),1),o("p",et,"峰值: "+u(I.value.peak),1)])])]),_:1})]),_:1}),t(m,{xs:24,sm:12,lg:6,class:"mb-20"},{default:l(()=>[t(p,{class:"stat-card",shadow:"hover"},{default:l(()=>[o("div",tt,[o("div",lt,[t(a,{name:"vulnerability"})]),o("div",ot,[e[15]||(e[15]=o("h3",null,"漏洞数量",-1)),o("p",st,u(M.value.total),1),o("p",at,"高危: "+u(M.value.critical),1)])])]),_:1})]),_:1})]),_:1}),t(z,{gutter:20,class:"dashboard-row"},{default:l(()=>[t(m,{xs:24,lg:16,class:"mb-20"},{default:l(()=>[t(p,{class:"chart-card",shadow:"hover"},{default:l(()=>[o("div",nt,[e[19]||(e[19]=o("h3",null,"网络流量趋势",-1)),t(ue,{modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=n=>D.value=n),size:"small",onChange:q},{default:l(()=>[t(B,{label:"day"},{default:l(()=>[...e[16]||(e[16]=[r("日",-1)])]),_:1}),t(B,{label:"week"},{default:l(()=>[...e[17]||(e[17]=[r("周",-1)])]),_:1}),t(B,{label:"month"},{default:l(()=>[...e[18]||(e[18]=[r("月",-1)])]),_:1})]),_:1},8,["modelValue"])]),o("div",it,[o("div",{ref_key:"trafficChartRef",ref:A,style:{height:"300px"}},null,512)])]),_:1})]),_:1}),t(m,{xs:24,lg:8,class:"mb-20"},{default:l(()=>[t(p,{class:"chart-card",shadow:"hover"},{default:l(()=>[e[20]||(e[20]=o("div",{class:"card-header"},[o("h3",null,"安全告警分布")],-1)),o("div",rt,[o("div",{ref_key:"alertChartRef",ref:F,style:{height:"300px"}},null,512)])]),_:1})]),_:1})]),_:1}),t(z,{gutter:20,class:"dashboard-row"},{default:l(()=>[t(m,{xs:24,class:"mb-20"},{default:l(()=>[t(p,{shadow:"hover"},{default:l(()=>[o("div",ut,[e[22]||(e[22]=o("h3",null,"最近安全事件",-1)),o("div",dt,[t(U,{modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=n=>L.value=n),placeholder:"搜索事件",style:{width:"200px"},clearable:""},{suffix:l(()=>[t(a,{name:"search"})]),_:1},8,["modelValue"]),t(v,{type:"primary",onClick:e[2]||(e[2]=n=>h.value=!0)},{default:l(()=>[...e[21]||(e[21]=[r("添加事件",-1)])]),_:1})])]),h.value?(g(),xe(ce,{key:0,model:d.value,rules:K,ref_key:"eventForm",ref:O,"label-width":"80px",class:"event-form"},{default:l(()=>[t(C,{label:"事件类型",prop:"type"},{default:l(()=>[t(de,{modelValue:d.value.type,"onUpdate:modelValue":e[3]||(e[3]=n=>d.value.type=n),placeholder:"请选择类型"},{default:l(()=>[t(G,{label:"高危",value:"高危"}),t(G,{label:"中危",value:"中危"}),t(G,{label:"低危",value:"低危"})]),_:1},8,["modelValue"])]),_:1}),t(C,{label:"来源",prop:"source"},{default:l(()=>[t(U,{modelValue:d.value.source,"onUpdate:modelValue":e[4]||(e[4]=n=>d.value.source=n)},null,8,["modelValue"])]),_:1}),t(C,{label:"描述",prop:"description"},{default:l(()=>[t(U,{type:"textarea",modelValue:d.value.description,"onUpdate:modelValue":e[5]||(e[5]=n=>d.value.description=n)},null,8,["modelValue"])]),_:1}),t(C,null,{default:l(()=>[t(v,{type:"primary",onClick:Z},{default:l(()=>[...e[23]||(e[23]=[r("提交",-1)])]),_:1}),t(v,{onClick:e[6]||(e[6]=n=>h.value=!1)},{default:l(()=>[...e[24]||(e[24]=[r("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])):k("",!0),t(pe,{data:X.value,style:{width:"100%"},border:"",stripe:""},{default:l(()=>[t(b,{prop:"time",label:"时间",width:"180",sortable:""}),t(b,{prop:"type",label:"类型",width:"120"},{default:l(({row:n})=>[t(H,{type:W(n.type)},{default:l(()=>[r(u(n.type),1)]),_:2},1032,["type"])]),_:1}),t(b,{prop:"source",label:"来源",width:"150"}),t(b,{prop:"description",label:"描述"}),t(b,{label:"操作",width:"120"},{default:l(({row:n})=>[t(v,{type:"text",size:"small",onClick:fe=>ee(n)},{default:l(()=>[...e[25]||(e[25]=[r("详情",-1)])]),_:1},8,["onClick"]),t(v,{type:"text",size:"small",onClick:fe=>te(n.id)},{default:l(()=>[...e[26]||(e[26]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),o("div",ct,[t(me,{"current-page":w.value,"page-size":T.value,total:f.value.length,layout:"prev, pager, next, jumper",onCurrentChange:Y},null,8,["current-page","page-size","total"])])]),_:1})]),_:1})]),_:1}),t(Q,{title:"事件详情",modelValue:_.value,"onUpdate:modelValue":e[9]||(e[9]=n=>_.value=n),width:"50%"},{footer:l(()=>[t(v,{onClick:e[7]||(e[7]=n=>_.value=!1)},{default:l(()=>[...e[29]||(e[29]=[r("关闭",-1)])]),_:1}),t(v,{type:"primary",onClick:e[8]||(e[8]=n=>oe(c.value))},{default:l(()=>[...e[30]||(e[30]=[r("处理事件",-1)])]),_:1})]),default:l(()=>[c.value?(g(),S("div",pt,[t(ve,{column:1,border:""},{default:l(()=>[t(E,{label:"时间"},{default:l(()=>[r(u(c.value.time),1)]),_:1}),t(E,{label:"类型"},{default:l(()=>[t(H,{type:W(c.value.type)},{default:l(()=>[r(u(c.value.type),1)]),_:1},8,["type"])]),_:1}),t(E,{label:"来源"},{default:l(()=>[r(u(c.value.source),1)]),_:1}),t(E,{label:"描述"},{default:l(()=>[r(u(c.value.description),1)]),_:1})]),_:1}),c.value.analysis?(g(),S("div",mt,[e[27]||(e[27]=o("h4",null,"安全分析",-1)),o("p",null,u(c.value.analysis),1)])):k("",!0),c.value.solution?(g(),S("div",vt,[e[28]||(e[28]=o("h4",null,"解决方案",-1)),o("p",null,u(c.value.solution),1)])):k("",!0)])):k("",!0)]),_:1},8,["modelValue"]),t(Q,{title:"确认删除",modelValue:y.value,"onUpdate:modelValue":e[11]||(e[11]=n=>y.value=n),width:"30%"},{footer:l(()=>[t(v,{onClick:e[10]||(e[10]=n=>y.value=!1)},{default:l(()=>[...e[31]||(e[31]=[r("取消",-1)])]),_:1}),t(v,{type:"danger",onClick:le},{default:l(()=>[...e[32]||(e[32]=[r("确认",-1)])]),_:1})]),default:l(()=>[e[33]||(e[33]=o("span",null,"确定要删除此安全事件记录吗？",-1))]),_:1},8,["modelValue"])])}}},Mt=_e(ft,[["__scopeId","data-v-c5f1de9d"]]);export{Mt as default};
