import{_ as pe}from"./_plugin-vue_export-helper--ScQKs0c.js";/* empty css                   *//* empty css                     *//* empty css                       *//* empty css                   *//* empty css                             *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                *//* empty css                             */import{r,m as O,z as me,c as $,o as V,e as l,w as a,E as fe,f as _e,d,i as ge,Y as he,j as be,J as Ce,$ as j,a0 as q,H as z,K as we,T as ye,U as Ve,k as v,L as xe,M as Ee,N as De,D as _,X as ke,O as Me,I as Le,P as Se,Q as $e,g as Te,h as Ue,F as ze,Z as Ie,l as I,_ as Ae}from"./index-Dr9TPxTp.js";const Be={class:"alarm-management"},Pe={class:"filter-container"},Fe={class:"table-header"},Ne={class:"pagination-container"},Re={class:"alarm-detail"},Ke={class:"detail-value"},Oe={class:"detail-value"},je={class:"detail-value"},qe={class:"detail-value"},Qe={class:"detail-value"},Ge={class:"description-content"},He={key:0,class:"action-buttons"},Je={class:"export-dialog"},Xe={__name:"AlarmManagement",setup(Ye){const Q=()=>{const t=["紧急","严重","警告","提示"],e=["未处理","已处理"],n=["防火墙","入侵检测","漏洞扫描","日志审计","网络流量"],s=["网络攻击告警","异常流量检测","系统漏洞告警","登录异常告警","配置变更告警","设备离线告警","病毒检测告警","数据泄露告警"],u=[];for(let c=1;c<=50;c++){const p=t[Math.floor(Math.random()*t.length)],D=e[Math.floor(Math.random()*e.length)],m=n[Math.floor(Math.random()*n.length)],h=s[Math.floor(Math.random()*s.length)];u.push({id:c,title:`${h} #${c}`,content:`检测到${m}${h}`,level:p,status:D,time:new Date(Date.now()-Math.floor(Math.random()*7*24*60*60*1e3)).toLocaleString(),source:m,description:`这是关于${h}的详细描述。告警级别为${p}，当前状态为${D}。需要相关人员及时${D==="未处理"?"处理":"确认"}。`})}return u},C=r([]),A=r(!0),w=r(""),x=r(""),E=r(""),f=r([]),g=r(1),k=r(10),y=r("time"),M=r("descending"),S=r(!1),i=r({}),L=r(!1),T=r("csv"),U=r([]),G=r([{value:"紧急",label:"紧急"},{value:"严重",label:"严重"},{value:"警告",label:"警告"},{value:"提示",label:"提示"}]),H=r([{value:"未处理",label:"未处理"},{value:"已处理",label:"已处理"}]),J=O(()=>{let t=C.value;if(w.value){const s=w.value.toLowerCase();t=t.filter(u=>u.title.toLowerCase().includes(s)||u.content.toLowerCase().includes(s)||u.source.toLowerCase().includes(s))}if(x.value&&(t=t.filter(s=>s.level===x.value)),E.value&&(t=t.filter(s=>s.status===E.value)),f.value&&f.value.length===2){const[s,u]=f.value;t=t.filter(c=>{const p=new Date(c.time);return p>=s&&p<=u})}y.value&&M.value&&(t=[...t].sort((s,u)=>{if(y.value==="time"){const c=new Date(s.time).getTime(),p=new Date(u.time).getTime();return M.value==="ascending"?c-p:p-c}return s[y.value]<u[y.value]?M.value==="ascending"?-1:1:s[y.value]>u[y.value]?M.value==="ascending"?1:-1:0}));const e=(g.value-1)*k.value,n=e+k.value;return t.slice(e,n)}),X=O(()=>{let t=C.value;if(w.value){const e=w.value.toLowerCase();t=t.filter(n=>n.title.toLowerCase().includes(e)||n.content.toLowerCase().includes(e)||n.source.toLowerCase().includes(e))}if(x.value&&(t=t.filter(e=>e.level===x.value)),E.value&&(t=t.filter(e=>e.status===E.value)),f.value&&f.value.length===2){const[e,n]=f.value;t=t.filter(s=>{const u=new Date(s.time);return u>=e&&u<=n})}return t.length}),B=t=>{switch(t){case"紧急":return"danger";case"严重":return"warning";case"警告":return"info";case"提示":return"";default:return""}},P=()=>{g.value=1},Y=()=>{w.value="",g.value=1},F=()=>{g.value=1},Z=()=>{g.value=1},W=t=>{k.value=t},ee=t=>{g.value=t},le=({prop:t,order:e})=>{y.value=t,M.value=e},te=t=>{i.value=t,S.value=!0},ae=()=>{const t=C.value.findIndex(e=>e.id===i.value.id);t!==-1&&(C.value[t].status="已处理",i.value.status="已处理",I.success("告警已标记为已处理"))},oe=()=>{Ae.confirm("确定要忽略此告警吗？忽略后该告警将不再显示","忽略告警确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=C.value.findIndex(e=>e.id===i.value.id);t!==-1&&(C.value.splice(t,1),S.value=!1,I.success("告警已忽略"))}).catch(()=>{})},se=()=>{L.value=!0,U.value=f.value.length===2?[...f.value]:[]},ne=()=>{L.value=!1,I.success(`告警数据已导出为${T.value.toUpperCase()}格式`)};return me(()=>{setTimeout(()=>{C.value=Q(),A.value=!1},800)}),(t,e)=>{const n=be,s=ge,u=we,c=Ce,p=ye,D=fe,m=Ee,h=De,ue=xe,re=Me,b=$e,ie=Se,N=_e,R=Ie,de=ze,K=Ue,ce=Te,ve=ke;return V(),$("div",Be,[l(D,{class:"filter-card",shadow:"hover"},{default:a(()=>[d("div",Pe,[l(s,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=o=>w.value=o),placeholder:"搜索告警内容",class:"search-input",clearable:"",onClear:Y,onKeyup:he(P,["enter"])},{append:a(()=>[l(n,{onClick:P},{default:a(()=>[...e[11]||(e[11]=[d("span",{class:"search-icon"},"🔍",-1)])]),_:1})]),_:1},8,["modelValue"]),l(c,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=o=>x.value=o),placeholder:"告警级别",class:"level-select",clearable:"",onChange:F},{default:a(()=>[(V(!0),$(j,null,q(G.value,o=>(V(),z(u,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(c,{modelValue:E.value,"onUpdate:modelValue":e[2]||(e[2]=o=>E.value=o),placeholder:"告警状态",class:"status-select",clearable:"",onChange:F},{default:a(()=>[(V(!0),$(j,null,q(H.value,o=>(V(),z(u,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(p,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=o=>f.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"date-picker",onChange:Z},null,8,["modelValue"])])]),_:1}),l(D,{class:"table-card",shadow:"hover"},{default:a(()=>[d("div",Fe,[e[13]||(e[13]=d("h3",null,"网络安全告警列表",-1)),l(n,{type:"primary",onClick:se,class:"export-btn"},{default:a(()=>[...e[12]||(e[12]=[v(" 导出报表 ",-1)])]),_:1})]),Ve((V(),z(ue,{data:J.value,style:{width:"100%"},"default-sort":{prop:"time",order:"descending"},onSortChange:le,stripe:"",border:""},{default:a(()=>[l(m,{prop:"id",label:"ID",width:"80",sortable:"",align:"center"}),l(m,{prop:"title",label:"告警标题","min-width":"180"}),l(m,{prop:"content",label:"告警内容","min-width":"250"}),l(m,{prop:"level",label:"级别",width:"100",sortable:"",align:"center"},{default:a(({row:o})=>[l(h,{type:B(o.level),effect:"light",class:"level-tag"},{default:a(()=>[v(_(o.level),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"status",label:"状态",width:"120",align:"center"},{default:a(({row:o})=>[l(h,{type:o.status==="已处理"?"success":"danger",effect:"light",class:"status-tag"},{default:a(()=>[v(_(o.status),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"time",label:"时间",width:"180",sortable:""}),l(m,{prop:"source",label:"来源",width:"120"}),l(m,{label:"操作",width:"120",fixed:"right",align:"center"},{default:a(({row:o})=>[l(n,{size:"small",type:"primary",plain:"",onClick:Ze=>te(o)},{default:a(()=>[...e[14]||(e[14]=[v(" 详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ve,A.value]]),d("div",Ne,[l(re,{"current-page":g.value,"onUpdate:currentPage":e[4]||(e[4]=o=>g.value=o),"page-size":k.value,"onUpdate:pageSize":e[5]||(e[5]=o=>k.value=o),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:X.value,onSizeChange:W,onCurrentChange:ee},null,8,["current-page","page-size","total"])])]),_:1}),l(N,{modelValue:S.value,"onUpdate:modelValue":e[6]||(e[6]=o=>S.value=o),title:`告警详情 - ${i.value.title}`,width:"50%",class:"alarm-detail-dialog"},{default:a(()=>[d("div",Re,[l(ie,{column:1,border:""},{default:a(()=>[l(b,{label:"告警ID"},{default:a(()=>[d("span",Ke,_(i.value.id),1)]),_:1}),l(b,{label:"告警标题"},{default:a(()=>[d("span",Oe,_(i.value.title),1)]),_:1}),l(b,{label:"告警内容"},{default:a(()=>[d("span",je,_(i.value.content),1)]),_:1}),l(b,{label:"告警级别"},{default:a(()=>[l(h,{type:B(i.value.level),effect:"light",class:"level-tag"},{default:a(()=>[v(_(i.value.level),1)]),_:1},8,["type"])]),_:1}),l(b,{label:"告警状态"},{default:a(()=>[l(h,{type:i.value.status==="已处理"?"success":"danger",effect:"light",class:"status-tag"},{default:a(()=>[v(_(i.value.status),1)]),_:1},8,["type"])]),_:1}),l(b,{label:"告警时间"},{default:a(()=>[d("span",qe,_(i.value.time),1)]),_:1}),l(b,{label:"告警来源"},{default:a(()=>[d("span",Qe,_(i.value.source),1)]),_:1}),l(b,{label:"详细描述"},{default:a(()=>[d("div",Ge,_(i.value.description),1)]),_:1})]),_:1}),i.value.status==="未处理"?(V(),$("div",He,[l(n,{type:"success",onClick:ae,class:"process-btn"},{default:a(()=>[...e[15]||(e[15]=[v(" 标记为已处理 ",-1)])]),_:1}),l(n,{type:"warning",onClick:oe,class:"ignore-btn"},{default:a(()=>[...e[16]||(e[16]=[v(" 忽略此告警 ",-1)])]),_:1})])):Le("",!0)])]),_:1},8,["modelValue","title"]),l(N,{modelValue:L.value,"onUpdate:modelValue":e[10]||(e[10]=o=>L.value=o),title:"导出告警报表",width:"30%"},{footer:a(()=>[l(n,{onClick:e[9]||(e[9]=o=>L.value=!1)},{default:a(()=>[...e[19]||(e[19]=[v("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:ne},{default:a(()=>[...e[20]||(e[20]=[v("确认导出",-1)])]),_:1})]),default:a(()=>[d("div",Je,[l(ce,{"label-width":"100px"},{default:a(()=>[l(K,{label:"导出格式"},{default:a(()=>[l(de,{modelValue:T.value,"onUpdate:modelValue":e[7]||(e[7]=o=>T.value=o)},{default:a(()=>[l(R,{label:"csv"},{default:a(()=>[...e[17]||(e[17]=[v("CSV",-1)])]),_:1}),l(R,{label:"excel"},{default:a(()=>[...e[18]||(e[18]=[v("Excel",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(K,{label:"时间范围"},{default:a(()=>[l(p,{modelValue:U.value,"onUpdate:modelValue":e[8]||(e[8]=o=>U.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])])}}},vl=pe(Xe,[["__scopeId","data-v-1732fe15"]]);export{vl as default};
