import{_ as ae}from"./_plugin-vue_export-helper--ScQKs0c.js";/* empty css                   *//* empty css                 *//* empty css                     *//* empty css               *//* empty css                     */import{r as n,p as V,J as se,n as k,c as M,o as C,b as o,S as oe,d as a,w as s,j as ne,i as re,O as ue,L as ie,W as de,s as ce,T as ve,X as me,f as pe,k as _e,l as m,P,Q as $,R as fe,M as ge,G as v,U as be,V as he,g as we,h as ye,a1 as Ve}from"./index-CBu6_2cB.js";const Ce={class:"alarm-container"},Ee={class:"alarm-header"},xe={class:"filter-area"},ke={class:"filter-group"},Me={class:"filter-group"},Se={class:"filter-group"},Ue={class:"alarm-statistics"},De={class:"stat-card critical"},Te={class:"stat-value"},ze={class:"stat-card warning"},Ae={class:"stat-value"},Le={class:"stat-card normal"},Be={class:"stat-value"},Pe={class:"stat-card minor"},$e={class:"stat-value"},Fe={class:"pagination-container"},Ie={__name:"Alarm",setup(Ne){const S=()=>Array.from({length:50},(l,e)=>({id:e+1,title:`系统${["CPU","内存","磁盘","网络"][e%4]}${["过载","不足","异常","中断"][e%4]}告警`,content:`检测到${["主服务器","数据库节点","应用服务","网络设备"][e%4]}${["性能下降","连接超时","响应异常","资源耗尽"][e%4]}，当前值：${Math.round(Math.random()*100)}%`,level:["紧急","严重","一般","轻微"][Math.floor(Math.random()*4)],status:["未处理","已处理"][Math.floor(Math.random()*2)],time:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toLocaleString()})),u=n([]),E=n(!0),p=n(""),g=n(""),b=n(""),i=n(1),_=n(10),f=n(!1),U=n(null),r=n({id:"",title:"",comment:""}),F=[{value:"紧急",label:"紧急"},{value:"严重",label:"严重"},{value:"一般",label:"一般"},{value:"轻微",label:"轻微"}],I=[{value:"未处理",label:"未处理"},{value:"已处理",label:"已处理"}],D=V(()=>{let l=u.value;if(p.value){const e=p.value.toLowerCase();l=l.filter(d=>d.title.toLowerCase().includes(e)||d.content.toLowerCase().includes(e))}return g.value&&(l=l.filter(e=>e.level===g.value)),b.value&&(l=l.filter(e=>e.status===b.value)),l}),N=V(()=>D.value.length),O=V(()=>{const l=(i.value-1)*_.value,e=l+_.value;return D.value.slice(l,e)}),h=V(()=>({critical:u.value.filter(l=>l.level==="紧急").length,warning:u.value.filter(l=>l.level==="严重").length,normal:u.value.filter(l=>l.level==="一般").length,minor:u.value.filter(l=>l.level==="轻微").length})),R=l=>{switch(l){case"紧急":return"danger";case"严重":return"warning";case"一般":return"primary";case"轻微":return"info";default:return""}},j=({row:l})=>l.status==="未处理"?"unprocessed-row":"",T=()=>{i.value=1},q=()=>{p.value="",i.value=1},z=()=>{i.value=1},K=l=>{U.value=l,r.value={id:l.id,title:l.title,comment:""},f.value=!0},Q=()=>{if(!r.value.comment){k.warning("请填写处理意见");return}const l=u.value.find(e=>e.id===U.value.id);l&&(l.status="已处理",k.success("告警处理成功"),f.value=!1)},G=l=>{Ve.confirm("确认关闭？未保存的处理意见将丢失","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l()}).catch(()=>{})},J=l=>{_.value=l},W=l=>{i.value=l},X=()=>(E.value=!0,new Promise(l=>{setTimeout(()=>{const e=S();l(e)},800)}));return se(async()=>{try{u.value=await X()}catch{k.error("获取告警数据失败，已使用模拟数据"),u.value=S()}finally{E.value=!1}}),(l,e)=>{const d=_e,w=re,A=fe,L=ue,y=ge,H=ie,c=be,B=he,Y=ve,Z=me,x=ye,ee=we,le=pe,te=de;return C(),M("div",Ce,[o("div",Ee,[e[11]||(e[11]=o("h2",{class:"system-title"},"泰捷欣监控设备数据压缩上传应用系统",-1)),e[12]||(e[12]=o("div",{class:"sub-title"},"告警监控中心",-1)),o("div",xe,[o("div",ke,[a(w,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),placeholder:"请输入告警标题或内容关键词",clearable:"",class:"search-input",onClear:q,onKeyup:ne(T,["enter"])},{append:s(()=>[a(d,{onClick:T},{default:s(()=>[...e[10]||(e[10]=[m("搜索",-1)])]),_:1})]),_:1},8,["modelValue"])]),o("div",Me,[a(L,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),placeholder:"全部告警级别",clearable:"",class:"level-select",onChange:z},{default:s(()=>[(C(),M(P,null,$(F,t=>a(A,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),o("div",Se,[a(L,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=t=>b.value=t),placeholder:"全部告警状态",clearable:"",class:"status-select",onChange:z},{default:s(()=>[(C(),M(P,null,$(I,t=>a(A,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])])]),o("div",Ue,[a(H,{gutter:20},{default:s(()=>[a(y,{span:6},{default:s(()=>[o("div",De,[e[13]||(e[13]=o("div",{class:"stat-title"},"紧急告警",-1)),o("div",Te,v(h.value.critical),1)])]),_:1}),a(y,{span:6},{default:s(()=>[o("div",ze,[e[14]||(e[14]=o("div",{class:"stat-title"},"严重告警",-1)),o("div",Ae,v(h.value.warning),1)])]),_:1}),a(y,{span:6},{default:s(()=>[o("div",Le,[e[15]||(e[15]=o("div",{class:"stat-title"},"一般告警",-1)),o("div",Be,v(h.value.normal),1)])]),_:1}),a(y,{span:6},{default:s(()=>[o("div",Pe,[e[16]||(e[16]=o("div",{class:"stat-title"},"轻微告警",-1)),o("div",$e,v(h.value.minor),1)])]),_:1})]),_:1})]),oe((C(),ce(Y,{data:O.value,style:{width:"100%"},"row-class-name":j,"element-loading-text":"数据加载中...",border:"",stripe:"","highlight-current-row":""},{default:s(()=>[a(c,{prop:"id",label:"告警ID",width:"100",align:"center"}),a(c,{prop:"title",label:"告警标题","min-width":"180"}),a(c,{prop:"content",label:"告警详情","min-width":"250"}),a(c,{prop:"level",label:"告警级别",width:"120",align:"center"},{default:s(({row:t})=>[a(B,{type:R(t.level),effect:"light"},{default:s(()=>[m(v(t.level),1)]),_:2},1032,["type"])]),_:1}),a(c,{prop:"status",label:"处理状态",width:"120",align:"center"},{default:s(({row:t})=>[a(B,{type:t.status==="已处理"?"success":"danger",effect:"light"},{default:s(()=>[m(v(t.status),1)]),_:2},1032,["type"])]),_:1}),a(c,{prop:"time",label:"发生时间",width:"180",align:"center"}),a(c,{label:"操作",width:"150",fixed:"right",align:"center"},{default:s(({row:t})=>[a(d,{size:"small",type:t.status==="未处理"?"primary":"info",disabled:t.status==="已处理",onClick:Oe=>K(t)},{default:s(()=>[m(v(t.status==="未处理"?"处理告警":"已处理"),1)]),_:2},1032,["type","disabled","onClick"])]),_:1})]),_:1},8,["data"])),[[te,E.value]]),o("div",Fe,[a(Z,{"current-page":i.value,"onUpdate:currentPage":e[3]||(e[3]=t=>i.value=t),"page-size":_.value,"onUpdate:pageSize":e[4]||(e[4]=t=>_.value=t),"page-sizes":[10,20,30,50],total:N.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:J,onCurrentChange:W},null,8,["current-page","page-size","total"])]),a(le,{modelValue:f.value,"onUpdate:modelValue":e[9]||(e[9]=t=>f.value=t),title:"处理告警",width:"500px","before-close":G},{footer:s(()=>[a(d,{onClick:e[8]||(e[8]=t=>f.value=!1)},{default:s(()=>[...e[17]||(e[17]=[m("取消",-1)])]),_:1}),a(d,{type:"primary",onClick:Q},{default:s(()=>[...e[18]||(e[18]=[m("确认处理",-1)])]),_:1})]),default:s(()=>[a(ee,{model:r.value,"label-width":"80px"},{default:s(()=>[a(x,{label:"告警ID"},{default:s(()=>[a(w,{modelValue:r.value.id,"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.id=t),disabled:""},null,8,["modelValue"])]),_:1}),a(x,{label:"告警标题"},{default:s(()=>[a(w,{modelValue:r.value.title,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.title=t),disabled:""},null,8,["modelValue"])]),_:1}),a(x,{label:"处理意见",required:""},{default:s(()=>[a(w,{modelValue:r.value.comment,"onUpdate:modelValue":e[7]||(e[7]=t=>r.value.comment=t),type:"textarea",rows:3,placeholder:"请输入处理意见"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},We=ae(Ie,[["__scopeId","data-v-79f09512"]]);export{We as default};
