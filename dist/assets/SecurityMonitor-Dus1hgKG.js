import{_ as me}from"./_plugin-vue_export-helper--ScQKs0c.js";/* empty css                   *//* empty css                   *//* empty css                             *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                       */import{i as q}from"./index-CUSTx1TY.js";/* empty css                *//* empty css                             */import{r as c,m as G,z as fe,c as H,o as k,e as t,w as a,E as _e,f as he,d as l,T as ge,A as be,C as ye,D as p,J as Ce,K as we,F as xe,G as Se,k as u,U as Ee,H as R,L as ke,M as De,N as Ve,V as Me,j as Le,W as ze,X as Te,O as Ie,i as Re,Y as $e,I as $,P as Ae,Q as Fe,l as J}from"./index-Dr9TPxTp.js";const Ue={class:"security-monitor-container"},Pe={class:"card-header"},Be={class:"time-range"},Oe={class:"statistics-grid"},Qe={class:"stat-item"},Xe={class:"stat-info"},Ne={class:"stat-value"},Ke={class:"stat-item"},We={class:"stat-info"},je={class:"stat-value"},qe={class:"stat-item"},Ge={class:"stat-info"},He={class:"stat-value"},Je={class:"stat-item"},Ye={class:"stat-info"},Ze={class:"stat-value"},et={class:"chart-section"},tt={class:"chart-header"},at={class:"chart-container"},lt={class:"chart-header"},st={class:"chart-container"},ot={class:"event-table"},nt={class:"table-header"},it={class:"table-actions"},rt={class:"pagination"},dt={key:0,class:"event-detail-content"},ut={class:"event-actions",style:{"margin-top":"20px"}},ct={__name:"SecurityMonitor",setup(pt){const b=c({attackCount:128,alertCount:56,protectedCount:24,onlineRate:98.5}),A=c([new Date(Date.now()-10080*60*1e3),new Date]),Y=()=>{x.value=!0,setTimeout(()=>{b.value={attackCount:Math.floor(Math.random()*50)+100,alertCount:Math.floor(Math.random()*30)+40,protectedCount:24,onlineRate:(Math.random()*2+97).toFixed(1)},X(),N(),v.value=z(100),x.value=!1},800)},F=c(null),U=c(null),M=c("all"),L=c("day");let y=null,C=null;const v=c(z(100)),w=c(""),x=c(!1),h=c(1),S=c(10),Z=G(()=>v.value.length),D=c(!1),i=c(null),ee=G(()=>{let s=[...v.value];if(w.value){const n=w.value.toLowerCase();s=s.filter(r=>r.type.toLowerCase().includes(n)||r.source.toLowerCase().includes(n)||r.target.toLowerCase().includes(n))}const e=(h.value-1)*S.value,d=e+S.value;return s.slice(e,d)}),P=()=>{h.value=1},te=()=>{w.value="",h.value=1},ae=()=>{x.value=!0,setTimeout(()=>{v.value=z(100),x.value=!1},800)},le=s=>{S.value=s},se=s=>{h.value=s},oe=s=>{B(s)},B=s=>{i.value=s,D.value=!0},O=s=>{if(!i.value)return;const e=v.value.findIndex(d=>d.id===i.value.id);e!==-1&&(s==="handle"?(v.value[e].status="已处理",i.value.status="已处理",J.success("事件已标记为已处理")):s==="ignore"&&(v.value[e].status="已忽略",i.value.status="已忽略",J.warning("事件已忽略")))},Q=s=>s===1?"":s===2?"warning":s===3?"danger":"info";function z(s){const e=["DDoS攻击","SQL注入","XSS攻击","暴力破解","端口扫描","恶意软件"],d=["未处理","已处理","处理中","已忽略"],n=[];for(let r=0;r<s;r++){const E=Math.floor(Math.random()*e.length),m=Math.floor(Math.random()*d.length),T=Math.floor(Math.random()*3)+1;n.push({id:`event-${r}`,time:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toLocaleString(),type:e[E],source:`192.168.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,target:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,level:T,status:d[m],description:`这是关于${e[E]}的详细描述，发生在${new Date().toLocaleDateString()}。攻击源IP为192.168.x.x，目标系统为10.0.x.x。系统已自动拦截该攻击并记录日志。`})}return n}const X=()=>{if(!y)return;const s=M.value;let e=[{value:35,name:"DDoS"},{value:28,name:"SQL注入"},{value:22,name:"XSS"},{value:15,name:"暴力破解"},{value:10,name:"其他"}];s!=="all"&&(e=e.filter(d=>s==="ddos"?d.name==="DDoS":s==="sql"?d.name==="SQL注入":s==="xss"?d.name==="XSS":s==="brute"?d.name==="暴力破解":!0)),y.setOption({series:[{data:e}]})},N=()=>{if(!C)return;const s=L.value;let e=[],d=[],n=[],r=[];s==="day"?(e=["1日","2日","3日","4日","5日","6日","7日"],d=[12,8,15,10,7,9,11],n=[5,7,3,8,6,4,7],r=[2,3,1,4,2,3,1]):s==="week"?(e=["第1周","第2周","第3周","第4周"],d=[45,38,52,47],n=[18,22,15,20],r=[7,10,5,8]):s==="month"&&(e=["1月","2月","3月","4月","5月","6月"],d=[120,95,110,105,115,125],n=[45,50,40,55,60,50],r=[15,20,12,18,22,25]),C.setOption({xAxis:{data:e},series:[{data:d},{data:n},{data:r}]})},ne=()=>{y=q(F.value),y.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center",textStyle:{color:"#666"}},series:[{name:"攻击类型",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:35,name:"DDoS"},{value:28,name:"SQL注入"},{value:22,name:"XSS"},{value:15,name:"暴力破解"},{value:10,name:"其他"}]}]}),C=q(U.value),C.setOption({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["低危","中危","高危"],textStyle:{color:"#666"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:["1日","2日","3日","4日","5日","6日","7日"],axisLine:{lineStyle:{color:"#DCDFE6"}},axisLabel:{color:"#606266"}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#DCDFE6"}},axisLabel:{color:"#606266"},splitLine:{lineStyle:{color:"#EBEEF5"}}},series:[{name:"低危",type:"bar",stack:"total",label:{show:!0,position:"inside"},emphasis:{focus:"series"},data:[12,8,15,10,7,9,11],itemStyle:{color:"#67C23A"}},{name:"中危",type:"bar",stack:"total",label:{show:!0,position:"inside"},emphasis:{focus:"series"},data:[5,7,3,8,6,4,7],itemStyle:{color:"#E6A23C"}},{name:"高危",type:"bar",stack:"total",label:{show:!0,position:"inside"},emphasis:{focus:"series"},data:[2,3,1,4,2,3,1],itemStyle:{color:"#F56C6C"}}]}),window.addEventListener("resize",()=>{y.resize(),C.resize()})};return fe(()=>{ne()}),(s,e)=>{var W;const d=ge,n=_e,r=ye,E=be,m=we,T=Ce,I=Se,ie=xe,re=Re,g=Le,f=De,V=Ve,K=Me,de=ke,ue=Ie,_=Fe,ce=Ae,pe=he,ve=Te;return k(),H("div",Ue,[t(n,{class:"dashboard-card"},{default:a(()=>[l("div",Pe,[e[11]||(e[11]=l("h2",null,"网络安全态势总览",-1)),l("div",Be,[t(d,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=o=>A.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",onChange:Y},null,8,["modelValue"])])]),l("div",Oe,[t(E,{gutter:20},{default:a(()=>[t(r,{xs:24,sm:12,md:6,lg:6},{default:a(()=>[t(n,{shadow:"hover",class:"stat-card"},{default:a(()=>[l("div",Qe,[e[13]||(e[13]=l("div",{class:"stat-icon danger"},[l("span",{class:"icon-text"},"!")],-1)),l("div",Xe,[l("div",Ne,p(b.value.attackCount),1),e[12]||(e[12]=l("div",{class:"stat-label"},"攻击事件",-1))])])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:6,lg:6},{default:a(()=>[t(n,{shadow:"hover",class:"stat-card"},{default:a(()=>[l("div",Ke,[e[15]||(e[15]=l("div",{class:"stat-icon warning"},[l("span",{class:"icon-text"},"⚠")],-1)),l("div",We,[l("div",je,p(b.value.alertCount),1),e[14]||(e[14]=l("div",{class:"stat-label"},"安全告警",-1))])])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:6,lg:6},{default:a(()=>[t(n,{shadow:"hover",class:"stat-card"},{default:a(()=>[l("div",qe,[e[17]||(e[17]=l("div",{class:"stat-icon success"},[l("span",{class:"icon-text"},"✓")],-1)),l("div",Ge,[l("div",He,p(b.value.protectedCount),1),e[16]||(e[16]=l("div",{class:"stat-label"},"防护设备",-1))])])]),_:1})]),_:1}),t(r,{xs:24,sm:12,md:6,lg:6},{default:a(()=>[t(n,{shadow:"hover",class:"stat-card"},{default:a(()=>[l("div",Je,[e[19]||(e[19]=l("div",{class:"stat-icon primary"},[l("span",{class:"icon-text"},"⏲")],-1)),l("div",Ye,[l("div",Ze,p(b.value.onlineRate)+"%",1),e[18]||(e[18]=l("div",{class:"stat-label"},"在线率",-1))])])]),_:1})]),_:1})]),_:1})]),l("div",et,[t(E,{gutter:20},{default:a(()=>[t(r,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(n,{class:"chart-card"},{header:a(()=>[l("div",tt,[e[20]||(e[20]=l("span",null,"攻击类型分布",-1)),t(T,{modelValue:M.value,"onUpdate:modelValue":e[1]||(e[1]=o=>M.value=o),size:"small",placeholder:"筛选攻击类型",onChange:X},{default:a(()=>[t(m,{label:"全部",value:"all"}),t(m,{label:"DDoS",value:"ddos"}),t(m,{label:"SQL注入",value:"sql"}),t(m,{label:"XSS",value:"xss"}),t(m,{label:"暴力破解",value:"brute"})]),_:1},8,["modelValue"])])]),default:a(()=>[l("div",at,[l("div",{ref_key:"attackChart",ref:F,class:"chart"},null,512)])]),_:1})]),_:1}),t(r,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(n,{class:"chart-card"},{header:a(()=>[l("div",lt,[e[24]||(e[24]=l("span",null,"威胁等级趋势",-1)),t(ie,{modelValue:L.value,"onUpdate:modelValue":e[2]||(e[2]=o=>L.value=o),size:"small",onChange:N},{default:a(()=>[t(I,{label:"day"},{default:a(()=>[...e[21]||(e[21]=[u("日",-1)])]),_:1}),t(I,{label:"week"},{default:a(()=>[...e[22]||(e[22]=[u("周",-1)])]),_:1}),t(I,{label:"month"},{default:a(()=>[...e[23]||(e[23]=[u("月",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:a(()=>[l("div",st,[l("div",{ref_key:"threatChart",ref:U,class:"chart"},null,512)])]),_:1})]),_:1})]),_:1})]),l("div",ot,[t(n,null,{header:a(()=>[l("div",nt,[e[27]||(e[27]=l("span",null,"最新安全事件",-1)),l("div",it,[t(re,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=o=>w.value=o),placeholder:"搜索事件",clearable:"",size:"small",style:{width:"200px","margin-right":"10px"},onClear:te,onKeyup:$e(P,["enter"])},null,8,["modelValue"]),t(g,{type:"primary",size:"small",onClick:P},{default:a(()=>[...e[25]||(e[25]=[u(" 搜索 ",-1)])]),_:1}),t(g,{size:"small",onClick:ae},{default:a(()=>[...e[26]||(e[26]=[u(" 刷新 ",-1)])]),_:1})])])]),default:a(()=>[Ee((k(),R(de,{data:ee.value,style:{width:"100%"},onRowClick:oe},{default:a(()=>[t(f,{prop:"time",label:"时间",width:"180",sortable:""}),t(f,{prop:"type",label:"类型",width:"120"},{default:a(({row:o})=>[t(V,{type:Q(o.level)},{default:a(()=>[u(p(o.type),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"source",label:"来源IP",width:"150"}),t(f,{prop:"target",label:"目标",width:"150"}),t(f,{prop:"level",label:"威胁等级",width:"120",sortable:""},{default:a(({row:o})=>[t(K,{modelValue:o.level,"onUpdate:modelValue":j=>o.level=j,disabled:"",colors:["#99A9BF","#F7BA2A","#FF9900"],max:3},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(f,{prop:"status",label:"状态",width:"120"},{default:a(({row:o})=>[t(V,{type:o.status==="已处理"?"success":"danger"},{default:a(()=>[u(p(o.status),1)]),_:2},1032,["type"])]),_:1}),t(f,{label:"操作",width:"120"},{default:a(({row:o})=>[t(g,{size:"small",onClick:ze(j=>B(o),["stop"])},{default:a(()=>[...e[28]||(e[28]=[u("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ve,x.value]]),l("div",rt,[t(ue,{"current-page":h.value,"onUpdate:currentPage":e[4]||(e[4]=o=>h.value=o),"page-size":S.value,"onUpdate:pageSize":e[5]||(e[5]=o=>S.value=o),"page-sizes":[10,20,50,100],total:Z.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:le,onCurrentChange:se},null,8,["current-page","page-size","total"])])]),_:1})])]),_:1}),t(pe,{modelValue:D.value,"onUpdate:modelValue":e[10]||(e[10]=o=>D.value=o),title:`安全事件详情 - ${((W=i.value)==null?void 0:W.type)||""}`,width:"50%"},{footer:a(()=>[t(g,{onClick:e[9]||(e[9]=o=>D.value=!1)},{default:a(()=>[...e[31]||(e[31]=[u("关闭",-1)])]),_:1})]),default:a(()=>[i.value?(k(),H("div",dt,[t(ce,{border:"",column:"2"},{default:a(()=>[t(_,{label:"事件时间"},{default:a(()=>[u(p(i.value.time),1)]),_:1}),t(_,{label:"事件类型"},{default:a(()=>[t(V,{type:Q(i.value.level)},{default:a(()=>[u(p(i.value.type),1)]),_:1},8,["type"])]),_:1}),t(_,{label:"来源IP"},{default:a(()=>[u(p(i.value.source),1)]),_:1}),t(_,{label:"目标地址"},{default:a(()=>[u(p(i.value.target),1)]),_:1}),t(_,{label:"威胁等级"},{default:a(()=>[t(K,{modelValue:i.value.level,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value.level=o),disabled:"",max:3},null,8,["modelValue"])]),_:1}),t(_,{label:"处理状态"},{default:a(()=>[t(V,{type:i.value.status==="已处理"?"success":"danger"},{default:a(()=>[u(p(i.value.status),1)]),_:1},8,["type"])]),_:1}),t(_,{label:"事件描述",span:2},{default:a(()=>[u(p(i.value.description),1)]),_:1})]),_:1}),l("div",ut,[i.value.status!=="已处理"?(k(),R(g,{key:0,type:"primary",onClick:e[7]||(e[7]=o=>O("handle"))},{default:a(()=>[...e[29]||(e[29]=[u(" 立即处理 ",-1)])]),_:1})):$("",!0),i.value.status!=="已忽略"?(k(),R(g,{key:1,onClick:e[8]||(e[8]=o=>O("ignore"))},{default:a(()=>[...e[30]||(e[30]=[u(" 忽略事件 ",-1)])]),_:1})):$("",!0)])])):$("",!0)]),_:1},8,["modelValue","title"])])}}},kt=me(ct,[["__scopeId","data-v-6b4b9261"]]);export{kt as default};
